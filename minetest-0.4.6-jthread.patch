diff -urN minetest-0.4.6/src/ban.h minetest-0.4.6-patched/src/ban.h
--- minetest-0.4.6/src/ban.h	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/ban.h	2013-04-16 21:32:28.009259588 +1100
@@ -26,6 +26,8 @@
 #include <jmutex.h>
 #include "exceptions.h"
 
+using namespace jthread;
+
 class BanManager
 {
 public:
diff -urN minetest-0.4.6/src/debug.h minetest-0.4.6-patched/src/debug.h
--- minetest-0.4.6/src/debug.h	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/debug.h	2013-04-16 21:32:28.009759589 +1100
@@ -31,6 +31,8 @@
 #include "exceptions.h"
 #include <map>
 
+using namespace jthread;
+
 #ifdef _WIN32
 	#define WIN32_LEAN_AND_MEAN
 	#ifndef _WIN32_WINNT
diff -urN minetest-0.4.6/src/emerge.h minetest-0.4.6-patched/src/emerge.h
--- minetest-0.4.6/src/emerge.h	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/emerge.h	2013-04-16 21:32:28.009759589 +1100
@@ -11,6 +11,31 @@
 	{ if (enable_mapgen_debug_info) \
 	infostream << "EmergeThread: " x << std::endl; }
 
+/* ------ from local jthread ------ */
+#include <semaphore.h>
+
+class Event {
+sem_t sem;
+
+public:
+Event() {
+sem_init(&sem, 0, 0);
+}
+
+~Event() {
+sem_destroy(&sem);
+}
+
+void wait() {
+sem_wait(&sem);
+}
+
+void signal() {
+sem_post(&sem);
+}
+};
+/* ------ from local jthread ------ */
+
 class Mapgen;
 class MapgenParams;
 class MapgenFactory;
diff -urN minetest-0.4.6/src/main.cpp minetest-0.4.6-patched/src/main.cpp
--- minetest-0.4.6/src/main.cpp	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/main.cpp	2013-04-16 21:32:28.010259590 +1100
@@ -77,6 +77,8 @@
 #include "quicktune.h"
 #include "serverlist.h"
 
+using namespace jthread;
+
 /*
 	Settings.
 	These are loaded from the config file.
diff -urN minetest-0.4.6/src/profiler.h minetest-0.4.6-patched/src/profiler.h
--- minetest-0.4.6/src/profiler.h	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/profiler.h	2013-04-16 21:32:28.010259590 +1100
@@ -28,6 +28,8 @@
 #include "util/timetaker.h"
 #include "util/numeric.h" // paging()
 
+using namespace jthread;
+
 /*
 	Time profiler
 */
diff -urN minetest-0.4.6/src/quicktune.cpp minetest-0.4.6-patched/src/quicktune.cpp
--- minetest-0.4.6/src/quicktune.cpp	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/quicktune.cpp	2013-04-16 21:32:28.010259590 +1100
@@ -22,6 +22,8 @@
 #include <jmutexautolock.h>
 #include "util/string.h"
 
+using namespace jthread;
+
 std::string QuicktuneValue::getString()
 {
 	switch(type){
diff -urN minetest-0.4.6/src/server.cpp minetest-0.4.6-patched/src/server.cpp
--- minetest-0.4.6/src/server.cpp	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/server.cpp	2013-04-16 21:32:28.011259591 +1100
@@ -61,6 +61,8 @@
 #include "util/serialize.h"
 #include "defaultsettings.h"
 
+using namespace jthread;
+
 void * ServerThread::Thread()
 {
 	ThreadStarted();
diff -urN minetest-0.4.6/src/server.h minetest-0.4.6-patched/src/server.h
--- minetest-0.4.6/src/server.h	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/server.h	2013-04-16 21:32:28.011759591 +1100
@@ -42,6 +42,8 @@
 
 #define PP(x) "("<<(x).X<<","<<(x).Y<<","<<(x).Z<<")"
 
+using namespace jthread;
+
 struct LuaState;
 typedef struct lua_State lua_State;
 class IWritableItemDefManager;
diff -urN minetest-0.4.6/src/settings.h minetest-0.4.6-patched/src/settings.h
--- minetest-0.4.6/src/settings.h	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/settings.h	2013-04-16 21:32:28.011759591 +1100
@@ -37,6 +37,8 @@
 #include <map>
 #include <set>
 
+using namespace jthread;
+
 enum ValueType
 {
 	VALUETYPE_STRING,
diff -urN minetest-0.4.6/src/tile.cpp minetest-0.4.6-patched/src/tile.cpp
--- minetest-0.4.6/src/tile.cpp	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/tile.cpp	2013-04-16 21:32:28.012259592 +1100
@@ -33,6 +33,8 @@
 #include "util/thread.h"
 #include "util/numeric.h"
 
+using namespace jthread;
+
 /*
 	A cache from texture name to texture path
 */
diff -urN minetest-0.4.6/src/util/container.h minetest-0.4.6-patched/src/util/container.h
--- minetest-0.4.6/src/util/container.h	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/util/container.h	2013-04-16 21:32:28.012759593 +1100
@@ -27,6 +27,8 @@
 #include <list>
 #include <vector>
 
+using namespace jthread;
+
 /*
 	Queue with unique values with fast checking of value existence
 */
diff -urN minetest-0.4.6/src/util/thread.h minetest-0.4.6-patched/src/util/thread.h
--- minetest-0.4.6/src/util/thread.h	2013-04-04 07:41:18.000000000 +1100
+++ minetest-0.4.6-patched/src/util/thread.h	2013-04-16 21:32:28.012759593 +1100
@@ -25,6 +25,8 @@
 #include <jmutex.h>
 #include <jmutexautolock.h>
 
+using namespace jthread;
+
 template<typename T>
 class MutexedVariable
 {
